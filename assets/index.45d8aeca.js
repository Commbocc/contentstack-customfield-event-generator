var F=Object.defineProperty;var N=(a,s,i)=>s in a?F(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var S=(a,s,i)=>(N(a,typeof s!="symbol"?s+"":s,i),i);import{r as R,F as j,c as w,R as y,a as A,D as Y,b as B,C as J,w as W,d as O,o as c,e as d,f as e,g as $,h as x,u as n,i as f,v as h,j as E,t as b,k as D,l as L,n as P,m as H,p as T,q as K,s as z}from"./vendor.b1ab6e36.js";const G=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const _ of u.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function i(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=i(o);fetch(o.href,u)}};G();const t=R({freq:j.WEEKLY,dtstart:null,until:void 0,count:5,interval:1,byweekday:[],bymonth:[],bysetpos:void 0,dtend:null,limitByCount:!0});function U(a){const[s,i]=a.split("T"),[r,o,u]=s.split("-").map(l=>parseInt(l)),[_,C]=(i==null?void 0:i.split(":").map(l=>parseInt(l)))||[0,0];return new Date(Date.UTC(r,o-1,u,_,C,0))}const Z=w(()=>!t.dtend||!t.dtstart?0:U(t.dtend).valueOf()-U(t.dtstart).valueOf()),q=w(()=>{var a;if(!!t.dtstart)return new y({freq:t.freq,dtstart:U(t.dtstart),interval:(a=t.interval)!=null?a:void 0,count:t.limitByCount?t.count:void 0,until:!t.limitByCount&&t.until?new Date(t.until):void 0,byweekday:t.byweekday.length?t.byweekday:void 0,bymonth:t.bymonth.length?t.bymonth:void 0,bysetpos:t.bysetpos})}),Q=w(()=>{if(!q.value)return;const a=new A;return a.rrule(q.value),a}),X=a=>Y.fromJSDate(a).toUTC().setZone("local",{keepLocalTime:!0}).toJSDate(),ee=[{value:y.YEARLY,label:"Yearly"},{value:y.MONTHLY,label:"Monthly"},{value:y.WEEKLY,label:"Weekly"},{value:y.DAILY,label:"Daily"},{value:y.HOURLY,label:"Hourly"}],te=[{value:y.MO.weekday,label:"Monday"},{value:y.TU.weekday,label:"Tuesday"},{value:y.WE.weekday,label:"Wednesday"},{value:y.TH.weekday,label:"Thursday"},{value:y.FR.weekday,label:"Friday"},{value:y.SA.weekday,label:"Saturday"},{value:y.SU.weekday,label:"Sunday"}],ne=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];class oe{constructor(s){S(this,"active");S(this,"start_time");S(this,"saved");this.active=!0,this.start_time=s}get key(){return this.start_time.toISOString()}get end_time(){return new Date(this.start_time.valueOf()+Z.value)}get range(){const s=this.start_time.toLocaleDateString()===this.end_time.toLocaleDateString();return[this.start_time.toLocaleString(),s?this.end_time.toLocaleTimeString():this.end_time.toLocaleString()].join(" - ")}toEntry(){const{uid:s}=m.eventEntry,i=this.start_time.toISOString();return{title:[s,i].join("-"),url:`/events/${s}/${i}`,start_time:i,end_time:this.end_time.toISOString(),event:[{uid:s,_content_type_uid:"event"}]}}}const g=B(),se=()=>{var a;m.createConfirmation=!1,g.value=((a=Q.value)==null?void 0:a.all((s,i)=>i<m.instanceLimit).map(s=>new oe(X(s))))||null},M=w(()=>{var a;return((a=g.value)==null?void 0:a.filter(s=>s.active))||[]}),V=async()=>{const a=M.value.map(le);await Promise.allSettled(a),m.createConfirmation=!1};let p;const m=R({stack:null,eventEntry:null,instanceLimit:20,createConfirmation:!1});async function ae(){var a,s;try{p=await J.init(),p.window.enableAutoResizing(),m.instanceLimit=p.config.instanceLimit||20,m.stack=(a=p.stack)==null?void 0:a._data,m.eventEntry=(s=p.entry)==null?void 0:s._data,Object.assign(t,p.field.getData()),W(t,async()=>{g.value=null,await p.field.setData(t)})}catch{console.warn("Unable to load ContentStack extension.")}}async function le(a){try{const s=await p.stack.ContentType("event_instance").Entry.create({entry:a.toEntry()});console.log(s),a.saved=!0}catch{a.saved=!1}}const I=w(()=>{try{const{api_key:a}=m.stack,{uid:s,locale:i}=m.eventEntry,r=new URLSearchParams({query:JSON.stringify({queryObject:{_content_type_uid:{$in:["event_instance"]}},searchText:s})});return`https://app.contentstack.com/#!/stack/${a}/entries?${r.toString()}`}catch{return null}}),ie={class:"card-body"},re=e("label",{class:"form-label"},"Frequency",-1),ce={class:"mb-3"},de=["id","value"],ue=["for","textContent"],me=e("label",{class:"form-label"},"Start Date/Time",-1),fe={class:"w-75 mb-3"},ye=["max","required"],_e=e("label",{class:"form-label"},"End Date/Time",-1),pe={class:"w-75 mb-3"},be=["min","required"],he=e("label",{class:"form-label"},"Limit Occurrences",-1),ve={class:"w-75 mb-3"},ke={class:"form-check form-check-inline"},ge=e("label",{class:"form-check-label",for:"limit-count"},"By Count",-1),we={class:"form-check form-check-inline"},Ce=e("label",{class:"form-check-label",for:"limit-date"},"Until Date",-1),Se={key:0},$e=["max"],xe={key:1},Le={class:"form-text"},Ee=e("label",{class:"form-label"},"Interval",-1),De={class:"w-75 mb-3"},Ue=e("label",{class:"form-label"},"By Week Day",-1),qe={class:"mb-3"},Oe=["id","value"],Te=["for","textContent"],Ve=e("label",{class:"form-label"},"By Month",-1),Ie={class:"mb-3"},Re=["id","value"],Be=["for","textContent"],Me={class:"mb-3 w-75"},Fe=e("label",{for:""},"Set Posiiton",-1),Ne=e("div",{class:"form-text"}," Corresponds to the nth occurence (i.e. 3 for third, -2 for second to last) ",-1),je={class:"card-footer d-flex justify-content-between align-items-center"},Ae=["onClick"],Ye=O({setup(a){const s=B(),i=()=>{!s.value.reportValidity()||se()};return(r,o)=>{var u,_,C;return c(),d("form",{ref_key:"form",ref:s},[e("div",ie,[re,e("div",ce,[(c(!0),d($,null,x(n(ee),({value:l,label:v})=>(c(),d("div",{key:l,class:"form-check form-check-inline"},[f(e("input",{class:"form-check-input",type:"radio",name:"freqOptioins",id:`freq-${l}`,value:l,"onUpdate:modelValue":o[0]||(o[0]=k=>n(t).freq=k)},null,8,de),[[E,n(t).freq]]),e("label",{class:"form-check-label",for:`freq-${l}`,textContent:b(v)},null,8,ue)]))),128))]),me,e("div",fe,[f(e("input",{type:"datetime-local",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=l=>n(t).dtstart=l),max:(u=n(t).dtend)!=null?u:void 0,required:!n(t).dtstart},null,8,ye),[[h,n(t).dtstart]])]),_e,e("div",pe,[f(e("input",{type:"datetime-local",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=l=>n(t).dtend=l),min:(_=n(t).dtstart)!=null?_:void 0,required:!n(t).dtend},null,8,be),[[h,n(t).dtend]])]),he,e("div",ve,[e("div",ke,[f(e("input",{class:"form-check-input",type:"radio",name:"limitOptions",id:"limit-count",value:!0,"onUpdate:modelValue":o[3]||(o[3]=l=>n(t).limitByCount=l)},null,512),[[E,n(t).limitByCount]]),ge]),e("div",we,[f(e("input",{class:"form-check-input",type:"radio",name:"limitOptions",id:"limit-date",value:!1,"onUpdate:modelValue":o[4]||(o[4]=l=>n(t).limitByCount=l)},null,512),[[E,n(t).limitByCount]]),Ce]),n(t).limitByCount?(c(),d("div",Se,[f(e("input",{type:"number",min:"1",required:"",max:n(m).instanceLimit,"onUpdate:modelValue":o[5]||(o[5]=l=>n(t).count=l),class:"form-control"},null,8,$e),[[h,n(t).count]])])):(c(),d("div",xe,[f(e("input",{type:"date",class:"form-control",required:"","onUpdate:modelValue":o[6]||(o[6]=l=>n(t).until=l)},null,512),[[h,n(t).until]])])),e("div",Le," This generator is limited to creating "+b(n(m).instanceLimit)+" instances at a time. ",1)]),Ee,e("div",De,[f(e("input",{type:"number","onUpdate:modelValue":o[7]||(o[7]=l=>n(t).interval=l),class:"form-control",min:"1",required:""},null,512),[[h,n(t).interval]])]),Ue,e("div",qe,[(c(!0),d($,null,x(n(te),({value:l,label:v})=>(c(),d("div",{key:l,class:"form-check form-check-inline"},[f(e("input",{class:"form-check-input",type:"checkbox",id:`weekday-${l}`,value:l,"onUpdate:modelValue":o[8]||(o[8]=k=>n(t).byweekday=k)},null,8,Oe),[[L,n(t).byweekday]]),e("label",{class:"form-check-label",for:`weekday-${l}`,textContent:b(v)},null,8,Te)]))),128))]),Ve,e("div",Ie,[(c(!0),d($,null,x(n(ne),({value:l,label:v})=>(c(),d("div",{key:l,class:"form-check form-check-inline"},[f(e("input",{class:"form-check-input",type:"checkbox",id:`month-${l}`,value:l,"onUpdate:modelValue":o[9]||(o[9]=k=>n(t).bymonth=k)},null,8,Re),[[L,n(t).bymonth]]),e("label",{class:"form-check-label",for:`month-${l}`,textContent:b(v)},null,8,Be)]))),128))]),e("div",Me,[Fe,f(e("input",{type:"number",class:"form-control","onUpdate:modelValue":o[10]||(o[10]=l=>n(t).bysetpos=l)},null,512),[[h,n(t).bysetpos]]),Ne])]),e("footer",je,[e("span",null,b((C=n(q))==null?void 0:C.toText()),1),e("button",{type:"button",onClick:D(i,["prevent"]),class:"btn btn-primary btn-sm"}," Generate Instances ",8,Ae)])],512)}}}),Je={key:0,class:"card-body"},We={class:"list-group list-group-flush mb-3"},Pe=e("br",null,null,-1),He={class:"form-check"},Ke=["id","onUpdate:modelValue"],ze=["for"],Ge={class:"card-footer d-flex justify-content-between align-items-center"},Ze={class:"form-check"},Qe={class:"form-check-label",for:"confirmation"},Xe=["disabled"],et=O({setup(a){return(s,i)=>n(g)?(c(),d("form",{key:1,onSubmit:i[2]||(i[2]=D(()=>{},["prevent"]))},[e("ul",We,[(c(!0),d($,null,x(n(g),r=>(c(),d("li",{key:r.key,class:P(["list-group-item d-flex justify-content-between align-items-center",{"text-muted bg-light":!r.active,"list-group-item-success":r.saved,"list-group-item-danger":r.saved===!1}])},[e("div",null,[H(b(r.range)+" ",1),Pe,e("small",null,b(r.start_time),1)]),e("div",He,[f(e("input",{class:"form-check-input",type:"checkbox",id:`instance-${r.key}`,"onUpdate:modelValue":o=>r.active=o},null,8,Ke),[[L,r.active]]),e("label",{class:"form-check-label",for:`instance-${r.key}`}," Include ",8,ze)])],2))),128))]),e("div",Ge,[e("div",Ze,[f(e("input",{class:"form-check-input",type:"checkbox",id:"confirmation","onUpdate:modelValue":i[0]||(i[0]=r=>n(m).createConfirmation=r)},null,512),[[L,n(m).createConfirmation]]),e("label",Qe," Confirm creation of "+b(n(M).length)+" instance(s) of this event? ",1)]),e("button",{type:"button",class:"btn btn-warning",disabled:!n(m).createConfirmation,onClick:i[1]||(i[1]=D((...r)=>n(V)&&n(V)(...r),["prevent"]))}," Create Instances ",8,Xe)])],32)):(c(),d("div",Je,' Use the "Reoccurrence Rules" form above to generate instances of this event. '))}}),tt={key:0},nt={key:1},ot={key:2},st={open:"",class:"card my-3"},at=e("summary",{class:"card-header"},"Reoccurrence Rules",-1),lt={open:"",class:"card my-3"},it=e("summary",{class:"card-header"},"Generated Instances",-1),rt=e("hr",null,null,-1),ct=["href"],dt=O({setup(a){return ae(),(s,i)=>{var r;return n(m).eventEntry?((r=n(m).eventEntry)==null?void 0:r.uid)?(c(),d("aside",ot,[e("details",st,[at,T(Ye)]),e("details",lt,[it,T(et)]),rt,n(I)?(c(),d("a",{key:0,href:n(I),target:"_blank"}," Find Instances of this Event ",8,ct)):K("",!0)])):(c(),d("div",nt," Save the event before creating instances ")):(c(),d("div",tt," Must be used as a ContentStack extension "))}}});z(dt).mount("#app");
