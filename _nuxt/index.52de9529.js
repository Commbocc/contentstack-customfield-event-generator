import{a as g,b as m,e as w,f as T,h as K,i as x,k as f,j as $,o as i,l as v,w as y,v as S,m as n,p as b,q as L,t as k,u as a,c as R,r as U,s as V,x as B,y as M,z as O,A as I,B as D,C as N,D as h,E as Z,F as E,G as C,H as F,I as j}from"./entry.710cd3dd.js";const q={class:"grid"},z=g({__name:"ChangeDate",props:{ruleSet:null,dateKey:null},setup(o){const e=o,c=m(()=>new Date(w(e.dateKey))),{eventDurationMilliseconds:s}=T(e.ruleSet.fields);return K(()=>{e.ruleSet.rdates[e.dateKey]||(e.ruleSet.rdates[e.dateKey]={start:x(f(c.value)),end:s.value>0?x(f(new Date(c.value.valueOf()+s.value))):void 0})}),$(()=>{e.ruleSet.exceptions[e.dateKey]!=="Rescheduled"&&delete e.ruleSet.rdates[e.dateKey]}),(u,l)=>(i(),v("div",q,[y(n("input",{type:"datetime-local","onUpdate:modelValue":l[0]||(l[0]=t=>o.ruleSet.rdates[e.dateKey].start=t)},null,512),[[S,o.ruleSet.rdates[e.dateKey].start]]),y(n("input",{type:"datetime-local","onUpdate:modelValue":l[1]||(l[1]=t=>o.ruleSet.rdates[e.dateKey].end=t)},null,512),[[S,o.ruleSet.rdates[e.dateKey].end]])]))}}),Y=["id"],A=n("br",null,null,-1),G=n("option",{value:void 0},"Enabled",-1),H=n("option",{value:"Disabled"},"Disabled",-1),J=n("option",{value:"Cancelled"},"Cancelled",-1),P=n("option",{value:"Rescheduled"},"Rescheduled",-1),Q=[G,H,J,P],W=g({__name:"index",props:{instance:null},setup(o){const e=o,c=b().hash,{extensionField:s}=M(),u=m(()=>L(e.instance.date.toISOString())),l=m(()=>s.fieldData.ruleSets.find(t=>t.uuid===e.instance.setUuid));return(t,p)=>{const d=z;return i(),v("tr",{id:a(u),class:B({highlight:`#${a(u)}`===a(c)})},[n("th",null,[n("strong",null,k(("keepLocalTZ"in t?t.keepLocalTZ:a(f))(o.instance.date).toLocaleString()),1),A,n("small",null,k(("keepLocalTZ"in t?t.keepLocalTZ:a(f))(o.instance.date)),1),a(l).exceptions[a(u)]==="Rescheduled"?(i(),R(d,{key:0,"rule-set":a(l),"date-key":a(u)},null,8,["rule-set","date-key"])):U("",!0)]),n("td",null,[y(n("select",{"onUpdate:modelValue":p[0]||(p[0]=r=>a(l).exceptions[a(u)]=r)},Q,512),[[V,a(l).exceptions[a(u)]]])])],10,Y)}}});const X={class:"grid"},ee={key:0},te={key:1},ne={role:"grid"},se=g({__name:"index",setup(o){const{sets:e}=O(),{year:c}=b().query,s=I(c?parseInt(c.toString()):new Date().getFullYear()),u=m(()=>{var p;const l=new Date(Date.UTC(s.value,0,0)),t=new Date(Date.UTC(s.value,12,1));return(p=e.value)==null?void 0:p.flatMap(d=>d.rruleSet.between(l,t).map(r=>({date:r,setUuid:d.uuid}))).sort((d,r)=>d.date.valueOf()<r.date.valueOf()?-1:d.date.valueOf()>r.date.valueOf()?1:0)});return(l,t)=>{var r;const p=j,d=W;return i(),v(C,null,[n("div",X,[n("button",{onClick:t[0]||(t[0]=D(_=>s.value--,["prevent"])),class:"secondary"},"‹"),y(n("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=_=>N(s)?s.value=_:null),style:{"text-align":"center"}},null,512),[[S,a(s)]]),n("button",{onClick:t[2]||(t[2]=D(_=>s.value++,["prevent"])),class:"secondary"},"›")]),(r=a(u))!=null&&r.length?(i(),v("figure",te,[n("table",ne,[n("tbody",null,[(i(!0),v(C,null,F(a(u),_=>(i(),R(d,{instance:_},null,8,["instance"]))),256))])])])):(i(),v("article",ee,[h(" There are no instances of this event in "+k(a(s))+", ",1),Z(p,{to:"/rules"},{default:E(()=>[h("adjust the rules")]),_:1}),h(". ")]))],64)}}});export{se as default};
